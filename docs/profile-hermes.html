<!doctype html>
<html class="docs-version-0.67" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="React Native 中文网" href="/opensearch.xml">
<script src="//snack.expo.dev/embed.js" defer="defer"></script>
<script src="//cdn.wwads.cn/js/makemoney.js" defer="defer"></script><title data-react-helmet="true">Profiling with Hermes · React Native 中文网</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="twitter:image" content="https://reactnative.cn/img/logo-og.png"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.67"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.67"><meta data-react-helmet="true" property="og:url" content="https://reactnative.cn"><meta data-react-helmet="true" property="og:image" content="img/logo-og.png"><meta data-react-helmet="true" property="og:title" content="Profiling with Hermes · React Native 中文网"><meta data-react-helmet="true" name="description" content="You can visualize JavaScript&#x27;s performance in a React Native app using Hermes. Hermes is a small and lightweight JavaScript engine optimized for running React Native on Android (you can read more about using it with React Native here. Hermes helps improve app performance and also exposes ways to analyze the performance of the JavaScript that it runs."><meta data-react-helmet="true" property="og:description" content="You can visualize JavaScript&#x27;s performance in a React Native app using Hermes. Hermes is a small and lightweight JavaScript engine optimized for running React Native on Android (you can read more about using it with React Native here. Hermes helps improve app performance and also exposes ways to analyze the performance of the JavaScript that it runs."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://reactnative.cn/docs/profile-hermes"><link data-react-helmet="true" rel="alternate" href="https://reactnative.cn/docs/profile-hermes" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://reactnative.cn/docs/profile-hermes" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.a48218da.css">
<link rel="preload" href="/assets/js/runtime~main.2164e694.js" as="script">
<link rel="preload" href="/assets/js/main.290e9d64.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_3wvD">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/header_logo.svg" alt="React Native 中文网" class="themedImage_Ir0T themedImage--light_2_E0"><img src="/img/header_logo.svg" alt="React Native 中文网" class="themedImage_Ir0T themedImage--dark_2JiM"></div><b class="navbar__title">React Native 中文网</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/getting-started">0.67</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/profile-hermes">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/profile-hermes">0.67</a></li><li><a class="dropdown__link" href="/docs/0.66/profile-hermes">0.66</a></li><li><a class="dropdown__link" href="/docs/0.65/profile-hermes">0.65</a></li><li><a class="dropdown__link" href="/docs/0.64/profile-hermes">0.64</a></li><li><a class="dropdown__link" href="/docs/0.63/profile-hermes">0.63</a></li><li><a class="dropdown__link" href="/versions">所有版本</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">文档</a><a class="navbar__item navbar__link" href="/docs/components-and-apis">组件</a><a class="navbar__item navbar__link" href="/docs/accessibilityinfo">API</a><a class="navbar__item navbar__link" href="/docs/architecture-overview">架构</a><a href="//github.com/reactnativecn/react-native-website/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>讨论<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="//pushy.reactnative.cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link pushy"><span>热更新<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/about">关于</a><a href="//github.com/facebook/react-native" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-github-link" aria-label="GitHub repository"></a><div class="toggle_2wFP toggle_2vag toggleDisabled_1jUP"><div class="toggleTrack_OYnE" role="button" tabindex="-1"><div class="toggleTrackCheck_3aVv"><span class="toggleIcon_1mQT">🌜</span></div><div class="toggleTrackX_oB48"><span class="toggleIcon_1mQT">🌞</span></div><div class="toggleTrackThumb_3qal"></div></div><input type="checkbox" class="toggleScreenReader_bg_d" aria-label="Switch between dark and light mode"></div><div class="searchBox_WYtD"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_3jyA"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_2PbN" type="button"></button><aside class="docSidebarContainer_3jRz"><div class="sidebar_2j-V"><nav class="menu thin-scrollbar menu_1Xkn"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/getting-started">入门基础</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/environment-setup">环境搭建</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/running-on-device">开发流程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/style">设计</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_3-UD" href="/docs/performance">性能调优</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/performance">性能综述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/optimizing-flatlist-configuration">列表配置优化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ram-bundles-inline-requires">RAM Bundles 和内联引用优化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/profiling">Profiling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/profile-hermes">Profiling with Hermes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/javascript-environment">JavaScript 运行环境</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/native-modules-intro">原生模块</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/native-components-android">原生 UI 组件</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_3-UD" href="/docs/headless-js-android">Android 与 iOS 指南</a></div></li></ul></nav></div></aside><main class="docMainContainer_28SP"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2rXS"><div class="docItemContainer_1EXp"><article><div class="markdown"><header><h1>Profiling with Hermes</h1></header><p>You can visualize JavaScript&#x27;s performance in a React Native app using <a href="https://github.com/facebook/hermes" target="_blank" rel="noopener noreferrer">Hermes</a>. Hermes is a small and lightweight JavaScript engine optimized for running React Native on Android (you can <a href="/docs/hermes">read more about using it with React Native here</a>. Hermes helps improve app performance and also exposes ways to analyze the performance of the JavaScript that it runs.</p><p>In this section, you will learn how to profile your React Native app running on Hermes and how to visualize the profile using <a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference" target="_blank" rel="noopener noreferrer">the Performance tab on Chrome DevTools</a></p><blockquote><p>Be sure to <a href="/docs/hermes">enable hermes in your app</a> before you get started!</p></blockquote><p>Follow the instructions below to get started profiling:</p><ol><li><a href="/docs/profile-hermes#record-a-hermes-sampling-profile">Record a Hermes sampling profile</a></li><li><a href="/docs/profile-hermes#execute-command-from-cli">Execute command from CLI</a></li><li><a href="/docs/profile-hermes#open-the-downloaded-profile-on-chrome-devtools">Open the downloaded profile on Chrome DevTools</a></li></ol><h2 class="anchor anchorWithStickyNavbar_23Bc" id="record-a-hermes-sampling-profile">Record a Hermes sampling profile<a class="hash-link" href="#record-a-hermes-sampling-profile" title="Direct link to heading">​</a></h2><p>To record a sampling profiler from the Developer Menu:</p><ol><li>Navigate to your running Metro server terminal.</li><li>Press <code>d</code> to open the <strong>Developer Menu.</strong></li><li>Select <strong>Enable Sampling Profiler.</strong></li><li>Execute your JavaScript by in your app (press buttons, etc.)</li><li>Open the <strong>Developer Menu</strong> by pressing <code>d</code> again.</li><li>Select <strong>Disable Sampling Profiler</strong> to stop recording and save the sampling profiler.</li></ol><p>A toast will show the location where the sampling profiler has been saved, usually in <code>/data/user/0/com.appName/cache/*.cpuprofile</code></p><img src="https://cdn.jsdelivr.net/gh/reactnativecn/react-native-website@gh-pages/docs/assets/HermesProfileSaved.png" height="465" width="250" alt="Toast Notification of Profile saving"><h2 class="anchor anchorWithStickyNavbar_23Bc" id="execute-command-from-cli">Execute command from CLI<a class="hash-link" href="#execute-command-from-cli" title="Direct link to heading">​</a></h2><p>You can use the <a href="https://github.com/react-native-community/cli" target="_blank" rel="noopener noreferrer">React Native CLI</a> to convert the Hermes tracing profile to Chrome tracing profile, and then pull it to your local machine using:</p><div class="codeBlockContainer_1ukp language-sh theme-code-block"><div class="codeBlockContent_3Y8q sh"><pre tabindex="0" class="prism-code language-sh codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">npx react-native profile-hermes [destinationDir]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_23Bc" id="enabling-source-map">Enabling source map<a class="hash-link" href="#enabling-source-map" title="Direct link to heading">​</a></h3><p>A source map is used to enhance the profile and associate trace events with the application code. You can automatically generate a source map when converting the Hermes tracing profile to a Chrome tracing profile by enabling <code>bundleInDebug</code> if the app is running in development mode. This allows React Native to build the bundle during its running process. Here&#x27;s how:</p><ol><li>In your app&#x27;s <code>android/app/build.gradle</code> file, add:</li></ol><div class="codeBlockContainer_1ukp language-java theme-code-block"><div class="codeBlockContent_3Y8q java"><pre tabindex="0" class="prism-code language-java codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">project.ext.react = [</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  bundleInDebug: true,</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><blockquote><p>Be sure to clean the build whenever you make any changes to <code>build.gradle</code></p></blockquote><ol start="2"><li>Clean the build by running:</li></ol><div class="codeBlockContainer_1ukp language-sh theme-code-block"><div class="codeBlockContent_3Y8q sh"><pre tabindex="0" class="prism-code language-sh codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">cd android &amp;&amp; ./gradlew clean</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><ol start="3"><li>Run your app:</li></ol><div class="codeBlockContainer_1ukp language-sh theme-code-block"><div class="codeBlockContent_3Y8q sh"><pre tabindex="0" class="prism-code language-sh codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">npx react-native run-android</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_23Bc" id="common-errors">Common errors<a class="hash-link" href="#common-errors" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_23Bc" id="adb-no-devicesemulators-found-or-adb-device-offline"><code>adb: no devices/emulators found</code> or <code>adb: device offline</code><a class="hash-link" href="#adb-no-devicesemulators-found-or-adb-device-offline" title="Direct link to heading">​</a></h4><ul><li><strong>Why this happens</strong> The CLI cannot access the device or emulator (through adb) you are using to run the app.</li><li><strong>How to fix</strong> Make sure your Android device/emulator is connected and running. The command only works when it can access adb.</li></ul><h4 class="anchor anchorWithStickyNavbar_23Bc" id="there-is-no-file-in-the-cache-directory"><code>There is no file in the cache/ directory</code><a class="hash-link" href="#there-is-no-file-in-the-cache-directory" title="Direct link to heading">​</a></h4><ul><li><strong>Why this happens</strong> The CLI cannot find any <strong>.cpuprofile</strong> file in your app&#x27;s <strong>cache/</strong> directory. You might have forgotten to record a profile from the device.</li><li><strong>How to fix</strong> Follow the <a href="/docs/profile-hermes#record-a-hermes-sampling-profile">instructions</a> to enable/disable profiler from device.</li></ul><h4 class="anchor anchorWithStickyNavbar_23Bc" id="error-your_profile_namecpuprofile-is-an-empty-file"><code>Error: your_profile_name.cpuprofile is an empty file</code><a class="hash-link" href="#error-your_profile_namecpuprofile-is-an-empty-file" title="Direct link to heading">​</a></h4><ul><li><strong>Why this happens</strong> The profile is empty, it might be because Hermes is not running correctly.</li><li><strong>How to fix</strong> Make sure your app is running on the latest version of Hermes.</li></ul><h2 class="anchor anchorWithStickyNavbar_23Bc" id="open-the-downloaded-profile-in-chrome-devtools">Open the downloaded profile in Chrome DevTools<a class="hash-link" href="#open-the-downloaded-profile-in-chrome-devtools" title="Direct link to heading">​</a></h2><p>To open the profile in Chrome DevTools:</p><ol><li><p>Open Chrome DevTools.</p></li><li><p>Select the <strong>Performance</strong> tab.</p></li><li><p>Right click and choose <strong>Load profile...</strong></p><img src="https://cdn.jsdelivr.net/gh/reactnativecn/react-native-website@gh-pages/docs/assets/openChromeProfile.png" alt="Loading a performance profile on Chrome DevTools"></li></ol><h2 class="anchor anchorWithStickyNavbar_23Bc" id="how-does-the-hermes-profile-transformer-work">How does the Hermes Profile Transformer work?<a class="hash-link" href="#how-does-the-hermes-profile-transformer-work" title="Direct link to heading">​</a></h2><p>The Hermes Sample Profile is of the <code>JSON object format</code>, while the format that Google&#x27;s DevTools supports is <code>JSON Array Format</code>. (More information about the formats can be found on the <a href="https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview" target="_blank" rel="noopener noreferrer">Trace Event Format Document</a>)</p><div class="codeBlockContainer_1ukp language-ts theme-code-block"><div class="codeBlockContent_3Y8q ts"><pre tabindex="0" class="prism-code language-ts codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token keyword" style="color:#c5a5c5">export</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:#fac863">HermesCPUProfile</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  traceEvents</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token maybe-class-name">SharedEventProperties</span><span class="token punctuation" style="color:#657b83">[</span><span class="token punctuation" style="color:#657b83">]</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  samples</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token maybe-class-name">HermesSample</span><span class="token punctuation" style="color:#657b83">[</span><span class="token punctuation" style="color:#657b83">]</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  stackFrames</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">[</span><span class="token plain">key </span><span class="token keyword" style="color:#c5a5c5">in</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">]</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token maybe-class-name">HermesStackFrame</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">}</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>The Hermes profile has most of its information encoded into the <code>samples</code> and <code>stackFrames</code> properties. Each sample is a snapshot of the function call stack at that particular timestamp as each sample has a <code>sf</code> property which corresponds to a function call.</p><div class="codeBlockContainer_1ukp language-ts theme-code-block"><div class="codeBlockContent_3Y8q ts"><pre tabindex="0" class="prism-code language-ts codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token keyword" style="color:#c5a5c5">export</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:#fac863">HermesSample</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  cpu</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  name</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  ts</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  pid</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">number</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  tid</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  weight</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token comment" style="color:#93a1a1">/**</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token comment" style="color:#93a1a1">   * Will refer to an element in the stackFrames object of the Hermes Profile</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token comment" style="color:#93a1a1">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  sf</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">number</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  stackFrameData</span><span class="token operator" style="color:#fc929e">?</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token maybe-class-name">HermesStackFrame</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>The information about a function call can be found in <code>stackFrames</code> which contains key-object pairs, where the key is the <code>sf</code> number and the corresponding object gives us all the relevant information about the function including the <code>sf</code> number of its parent function. This parent-child relationship can be traced upwards to find the information of all the functions running at a particular timestamp.</p><div class="codeBlockContainer_1ukp language-ts theme-code-block"><div class="codeBlockContent_3Y8q ts"><pre tabindex="0" class="prism-code language-ts codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token keyword" style="color:#c5a5c5">export</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:#fac863">HermesStackFrame</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  line</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  column</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  funcLine</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  funcColumn</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  name</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  category</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">string</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  </span><span class="token comment" style="color:#93a1a1">/**</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token comment" style="color:#93a1a1">   * A parent function may or may not exist</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token comment" style="color:#93a1a1">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">  parent</span><span class="token operator" style="color:#fc929e">?</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token builtin" style="color:#2aa198">number</span><span class="token punctuation" style="color:#657b83">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>At this point, you should define a few more terms, namely:</p><ol><li>Nodes: The objects corresponding to <code>sf</code> numbers in <code>stackFrames</code></li><li>Active Nodes: The nodes which are currently running at a particular timestamp. A node is classified as running if its <code>sf</code> number is in the function call stack. This call stack can be obtained from the <code>sf</code> number of the sample and tracing upwards till parent <code>sf</code>s are available</li></ol><p>The <code>samples</code> and the <code>stackFrames</code> in tandem can then be used to generate all the start and end events at the corresponding timestamps, wherein:</p><ol><li>Start Nodes/Events: Nodes absent in the previous sample&#x27;s function call stack but present in the current sample&#x27;s.</li><li>End Nodes/Events: Nodes present in the previous sample&#x27;s function call stack but absent in the current sample&#x27;s.</li></ol><img src="https://cdn.jsdelivr.net/gh/reactnativecn/react-native-website@gh-pages/docs/assets/CallStackDemo.jpg" height="800" width="600" alt="CallStack Terms Explained"><p>You can now construct a <code>flamechart</code> of function calls as you have all the function information including its start and end timestamps.</p><p>The <code>hermes-profile-transformer</code> can convert any profile generated using Hermes into a format that can be directly displayed in Chrome DevTools. More information about this can be found on <a href="https://github.com/react-native-community/hermes-profile-transformer" target="_blank" rel="noopener noreferrer"> <code>@react-native-community/hermes-profile-transformer</code> </a></p></div><footer class="docMetadata row docusaurus-mt-lg"><div class="col"><a href="https://github.com/reactnativecn/react-native-website/blob/production/cnwebsite/../cndocs/profile-hermes.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_1CBY" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_1szQ"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_rbnR thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#record-a-hermes-sampling-profile" class="table-of-contents__link toc-highlight">Record a Hermes sampling profile</a></li><li><a href="#execute-command-from-cli" class="table-of-contents__link toc-highlight">Execute command from CLI</a><ul><li><a href="#enabling-source-map" class="table-of-contents__link toc-highlight">Enabling source map</a></li><li><a href="#common-errors" class="table-of-contents__link toc-highlight">Common errors</a></li></ul></li><li><a href="#open-the-downloaded-profile-in-chrome-devtools" class="table-of-contents__link toc-highlight">Open the downloaded profile in Chrome DevTools</a></li><li><a href="#how-does-the-hermes-profile-transformer-work" class="table-of-contents__link toc-highlight">How does the Hermes Profile Transformer work?</a></li></ul><div class="wwads-cn wwads-vertical" data-id="58" style="max-width:200px;margin-top:20px"></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">React Native 中文网 © 2022 武汉青罗网络科技有限公司
      <a style="margin-left:10px" href="http://beian.miit.gov.cn/">鄂ICP备20002031号-3</a>
      <img style="width:25px" src="//img.alicdn.com/tfs/TB1..50QpXXXXX7XpXXXXXXXXXX-40-40.png" alt="鄂公网安备 42011202001821号">
      <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42011202001821">鄂公网安备 42011202001821号</a>
      </div></div></div></footer></div>
<script src="/assets/js/runtime~main.2164e694.js"></script>
<script src="/assets/js/main.290e9d64.js"></script>
</body>
</html>