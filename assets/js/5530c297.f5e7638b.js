"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[78209],{35318:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var r=n(27378);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(n),m=o,f=u["".concat(p,".").concat(m)]||u[m]||s[m]||i;return n?r.createElement(f,a(a({ref:t},d),{},{components:n})):r.createElement(f,a({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},31043:(e,t,n)=>{n.d(t,{ZP:()=>m});var r=n(35318),o=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))p.call(t,n)&&d(e,n,t[n]);if(l)for(var n of l(t))c.call(t,n)&&d(e,n,t[n]);return e};const u={toc:[]};function m(e){var t,n=e,{components:o}=n,d=((e,t)=>{var n={};for(var r in e)p.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&l)for(var r of l(e))t.indexOf(r)<0&&c.call(e,r)&&(n[r]=e[r]);return n})(n,["components"]);return(0,r.kt)("wrapper",(t=s(s({},u),d),i(t,a({components:o,mdxType:"MDXLayout"}))),(0,r.kt)("admonition",s({},{title:"\u6ce8\u610f",type:"caution"}),(0,r.kt)("p",{parentName:"admonition"},"\u8fd9\u4e2a\u6587\u6863\u4ecd\u7136\u662f",(0,r.kt)("strong",{parentName:"p"},"\u5b9e\u9a8c\u6027"),"\u7684\uff0c\u968f\u7740\u6211\u4eec\u7684\u8fed\u4ee3\uff0c\u7ec6\u8282\u4f1a\u6709\u53d8\u5316\u3002\u6b22\u8fce\u5728",(0,r.kt)("a",s({parentName:"p"},{href:"https://github.com/reactwg/react-native-new-architecture/discussions/8"}),"\u5de5\u4f5c\u5c0f\u7ec4\u5185\u7684\u8ba8\u8bba"),"\u4e2d\u5206\u4eab\u4f60\u7684\u53cd\u9988\u3002"),(0,r.kt)("p",{parentName:"admonition"},"\u6b64\u5916\uff0c\u5b83\u8fd8\u5305\u542b\u51e0\u4e2a",(0,r.kt)("strong",{parentName:"p"},"\u624b\u52a8\u6b65\u9aa4"),"\u3002\u8bf7\u6ce8\u610f\u65b0\u67b6\u6784\u5c1a\u672a\u7a33\u5b9a\u4e0b\u6765\uff0c\u6700\u7ec8\u7684\u5f00\u53d1\u8005\u4f53\u9a8c\u4f1a\u7ee7\u7eed\u8fed\u4ee3\u6539\u5584\u3002\u6211\u4eec\u6b63\u5728\u52aa\u529b\u5f00\u53d1\u5de5\u5177\u3001\u6a21\u677f\u548c\u5e93\uff0c\u4ee5\u5e2e\u52a9\u4f60\u5728\u65b0\u67b6\u6784\u4e0a\u5feb\u901f\u5165\u95e8\uff0c\u800c\u4e0d\u9700\u8981\u7ecf\u5386\u6574\u4e2a\u8bbe\u7f6e\u8fc7\u7a0b\u3002")))}m.isMDXComponent=!0},71974:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>y,contentTitle:()=>f,default:()=>k,frontMatter:()=>m,metadata:()=>h,toc:()=>b});var r=n(35318),o=n(31043),i=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,s=(e,t,n)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&s(e,n,t[n]);if(p)for(var n of p(t))d.call(t,n)&&s(e,n,t[n]);return e};const m={id:"new-architecture-troubleshooting",title:"\u5e38\u89c1\u95ee\u9898"},f=void 0,h={unversionedId:"new-architecture-troubleshooting",id:"version-0.71/new-architecture-troubleshooting",title:"\u5e38\u89c1\u95ee\u9898",description:"\u672c\u9875\u9762\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u8fc1\u79fb\u5230\u65b0\u67b6\u6784\u65f6\u53ef\u80fd\u9047\u5230\u7684\u5e38\u89c1\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6848\u3002",source:"@site/versioned_docs/version-0.71/new-architecture-troubleshooting.md",sourceDirName:".",slug:"/new-architecture-troubleshooting",permalink:"/docs/new-architecture-troubleshooting",draft:!1,editUrl:"https://github.com/reactnativecn/react-native-website/blob/production/cnwebsite/../cndocs/new-architecture-troubleshooting.md",tags:[],version:"0.71",frontMatter:{id:"new-architecture-troubleshooting",title:"\u5e38\u89c1\u95ee\u9898"},sidebar:"docs",previous:{title:"React 18 \u4e0e React Native",permalink:"/docs/react-18-and-react-native"},next:{title:"Appendix",permalink:"/docs/new-architecture-appendix"}},y={},b=[{value:"Xcode \u7f16\u8bd1\u62a5\u9519",id:"xcode-\u7f16\u8bd1\u62a5\u9519",level:2},{value:"\u91cd\u7f6e CocoaPods \u4e0e Node",id:"\u91cd\u7f6e-cocoapods-\u4e0e-node",level:2},{value:"Folly \u7684\u7248\u672c\u95ee\u9898",id:"folly-\u7684\u7248\u672c\u95ee\u9898",level:2},{value:"Android \u7f16\u8bd1\u65f6\u78b0\u5230\u5185\u5b58\u4e0d\u8db3\u7684\u62a5\u9519<code>OutOfMemoryException</code>",id:"android-\u7f16\u8bd1\u65f6\u78b0\u5230\u5185\u5b58\u4e0d\u8db3\u7684\u62a5\u9519outofmemoryexception",level:2},{value:"Android NDK and Mac with M1 Apple Silicon CPUs",id:"android-ndk-and-mac-with-m1-apple-silicon-cpus",level:2}],v={toc:b};function k(e){var t,n=e,{components:i}=n,s=((e,t)=>{var n={};for(var r in e)c.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&p)for(var r of p(e))t.indexOf(r)<0&&d.call(e,r)&&(n[r]=e[r]);return n})(n,["components"]);return(0,r.kt)("wrapper",(t=u(u({},v),s),a(t,l({components:i,mdxType:"MDXLayout"}))),(0,r.kt)(o.ZP,{mdxType:"NewArchitectureWarning"}),(0,r.kt)("p",null,"\u672c\u9875\u9762\u4f1a\u8bb0\u5f55\u4e00\u4e9b\u8fc1\u79fb\u5230\u65b0\u67b6\u6784\u65f6\u53ef\u80fd\u9047\u5230\u7684\u5e38\u89c1\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6848\u3002"),(0,r.kt)("h2",u({},{id:"xcode-\u7f16\u8bd1\u62a5\u9519"}),"Xcode \u7f16\u8bd1\u62a5\u9519"),(0,r.kt)("p",null,"\u5982\u679c\u5728 XCode \u7f16\u8bd1\u65f6\u78b0\u5230\u7c7b\u4f3c\u4e0b\u9762\u7684\u62a5\u9519:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Command PhaseScriptExecution failed with a nonzero exit code")),(0,r.kt)("p",null,"\u6b64\u9519\u8bef\u8868\u793a\u6ce8\u5165\u5230 Xcode \u6784\u5efa\u7ba1\u9053\u4e2d\u7684 codegen \u811a\u672c\u5df2\u7ecf\u63d0\u524d\u9000\u51fa\u3002\u60a8\u53ef\u80fd\u4f1a\u5728\u81ea\u5df1\u7684\u5e93\u6216\u67d0\u4e00\u4e2a\u6838\u5fc3 RN \u5e93\uff08FBReactNativeSpec\uff0crncore\uff09\u4e2d\u9047\u5230\u6b64\u95ee\u9898\u3002"),(0,r.kt)("p",null,"\u6253\u5f00",(0,r.kt)("inlineCode",{parentName:"p"},"~/Library/Developer/Xcode/DerivedData"),"\uff0c\u67e5\u627e\u4ee5\u60a8\u7684 Xcode \u5de5\u4f5c\u533a\u547d\u540d\u7684\u6587\u4ef6\u5939\uff08\u4f8b\u5982\u201cRNTesterPods-AAAA\u201d\uff0c\u5176\u4e2d\u201cAAAA\u201d\u662f\u4e00\u4e32\u5b57\u7b26\uff09\u3002\u5728\u8be5\u6587\u4ef6\u5939\u4e2d\uff0c\u8f6c\u5230 Build \u2192 Intermediates.noindex \u2192 Pods.build \u2192 Debug-iphonesimulator\uff08\u6216\u9002\u7528\u4e8e\u60a8\u7684 iOS \u8bbe\u5907\u7684\u7b49\u6548\u6587\u4ef6\u5939\uff09\u3002\u5728\u5176\u4e2d\uff0c\u67e5\u627e\u4ee5 codegen \u5e93\u547d\u540d\u7684\u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u811a\u672c\u9519\u8bef\u3002\u811a\u672c\u9636\u6bb5\u7684\u65e5\u5fd7\u53ef\u4ee5\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"DerivedSources"),"\u6587\u4ef6\u5939\u4e2d\u627e\u5230\uff0c\u6587\u4ef6\u540d\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"codegen-LibraryName.log"),"\u3002\u6b64\u65e5\u5fd7\u8f93\u51fa\u5e94\u63d0\u4f9b\u6709\u5173\u9519\u8bef\u6765\u6e90\u7684\u4e00\u4e9b\u8bf4\u660e\u3002"),(0,r.kt)("h2",u({},{id:"\u91cd\u7f6e-cocoapods-\u4e0e-node"}),"\u91cd\u7f6e CocoaPods \u4e0e Node"),(0,r.kt)("p",null,"CocoaPods \u96c6\u6210\u5c06\u968f\u7740\u6211\u4eec\u63a8\u51fa\u65b0\u67b6\u6784\u800c\u9891\u7e41\u66f4\u65b0\uff0c\u53ef\u80fd\u4f1a\u5728\u8fd9\u4e9b\u66f4\u6539\u4e4b\u540e\u5bfc\u81f4\u60a8\u7684\u9879\u76ee\u65e0\u6cd5\u8fd0\u884c\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u5c1d\u8bd5\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\u6e05\u7406\u4e0e\u4ee3\u7801\u751f\u6210\u76f8\u5173\u7684\u4efb\u4f55\u66f4\u6539\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5728\u60a8\u7684 ios \u76ee\u5f55\uff08\u6216\u60a8\u7684 Podfile \u6240\u5728\u7684\u4efb\u4f55\u4f4d\u7f6e\uff09\u4e2d\u8fd0\u884c ",(0,r.kt)("inlineCode",{parentName:"li"},"pod deintegrate"),"\uff0c\u7136\u540e\u91cd\u65b0\u8fd0\u884c ",(0,r.kt)("inlineCode",{parentName:"li"},"pod install"),"\uff08\u6216 ",(0,r.kt)("inlineCode",{parentName:"li"},"arch -x86_64 pod install"),"\uff0c\u5982\u679c\u5728 Apple M1 \u82af\u7247\u7535\u8111\u4e2d\u78b0\u5230\u8fd0\u884c\u95ee\u9898\u7684\u8bdd\uff09\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5220\u9664 ",(0,r.kt)("inlineCode",{parentName:"li"},"Podfile.lock"),"\uff0c\u7136\u540e\u91cd\u65b0\u8fd0\u884c ",(0,r.kt)("inlineCode",{parentName:"li"},"pod install"),"\uff08\u6216 ",(0,r.kt)("inlineCode",{parentName:"li"},"arch -x86_64 pod install"),"\uff0c\u5982\u679c\u5728 Apple M1 \u82af\u7247\u7535\u8111\u4e2d\u78b0\u5230\u8fd0\u884c\u95ee\u9898\u7684\u8bdd\uff09\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5220\u9664 ",(0,r.kt)("inlineCode",{parentName:"li"},"node_modules"),"\uff0c\u7136\u540e\u91cd\u65b0\u8fd0\u884c ",(0,r.kt)("inlineCode",{parentName:"li"},"yarn install"),"\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5220\u9664\u60a8\u7684\u4ee3\u7801\u751f\u6210\u5de5\u4ef6\uff0c\u7136\u540e\u91cd\u65b0\u8fd0\u884c ",(0,r.kt)("inlineCode",{parentName:"li"},"pod install"),"\uff08\u6216 ",(0,r.kt)("inlineCode",{parentName:"li"},"arch -x86_64 pod install"),"\uff0c\u5982\u679c\u5728 Apple M1 \u82af\u7247\u7535\u8111\u4e2d\u78b0\u5230\u8fd0\u884c\u95ee\u9898\u7684\u8bdd\uff09\uff0c\u7136\u540e\u6e05\u7406\u5e76\u6784\u5efa\u60a8\u7684 Xcode \u9879\u76ee\u3002")),(0,r.kt)("h2",u({},{id:"folly-\u7684\u7248\u672c\u95ee\u9898"}),"Folly \u7684\u7248\u672c\u95ee\u9898"),(0,r.kt)("p",null,"\u60a8\u7684 podspec \u4e2d\u4f7f\u7528\u7684 Folly \u7248\u672c\u5fc5\u987b\u4e0e\u5f53\u524d React Native \u4f7f\u7528\u7684\u7248\u672c\u5339\u914d\u3002\u5982\u679c\u5728\u8fd0\u884c\u201cpod install\u201d\u540e\u770b\u5230\u4ee5\u4e0b\u9519\u8bef\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{}),'[!] CocoaPods could not find compatible versions for pod "RCT-Folly":\n')),(0,r.kt)("p",null,"...\u8fd9\u610f\u5473\u7740\u5f53\u524d\u7684\u7248\u672c\u53ef\u80fd\u4e0d\u5339\u914d\u3002\u68c0\u67e5\u4e0b ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules/react-native/React/FBReactNativeSpec/FBReactNativeSpec.podspec")," \u6587\u4ef6\u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"folly_version")," \u8bb0\u5f55\u7684\u7248\u672c\u3002\u7136\u540e\u5c06\u4f60\u81ea\u5df1\u7684 podspec \u4e2d\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"folly_version"),"\u8bbe\u4e3a\u4e00\u81f4\u7684\u7248\u672c\u3002"),(0,r.kt)("h2",u({},{id:"android-\u7f16\u8bd1\u65f6\u78b0\u5230\u5185\u5b58\u4e0d\u8db3\u7684\u62a5\u9519outofmemoryexception"}),"Android \u7f16\u8bd1\u65f6\u78b0\u5230\u5185\u5b58\u4e0d\u8db3\u7684\u62a5\u9519",(0,r.kt)("inlineCode",{parentName:"h2"},"OutOfMemoryException")),(0,r.kt)("p",null,"If your Android Gradle builds are failing with: ",(0,r.kt)("inlineCode",{parentName:"p"},"OutOfMemoryException: Out of memory: Java heap space.")," or similar errors related to low memory, you might need to increase the memory allocated to the JVM."),(0,r.kt)("p",null,"You can do that by editing the ",(0,r.kt)("inlineCode",{parentName:"p"},"gradle.properties")," file in your ",(0,r.kt)("inlineCode",{parentName:"p"},"android/gradle.properties")," folder:"),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{className:"language-diff"})," # Specifies the JVM arguments used for the daemon process.\n # The setting is particularly useful for tweaking memory settings.\n # Default value: -Xmx1024m -XX:MaxPermSize=256m\n-# org.gradle.jvmargs=-Xmx2048m -XX:MaxPermSize=512m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8\n+org.gradle.jvmargs=-Xmx4g -XX:MaxPermSize=512m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8\n")),(0,r.kt)("p",null,"Make sure to uncomment the line and set the preferred memory size with the ",(0,r.kt)("inlineCode",{parentName:"p"},"-Xmx")," parameter. 2Gb should be the minimum required and 4Gb is recommended."),(0,r.kt)("h2",u({},{id:"android-ndk-and-mac-with-m1-apple-silicon-cpus"}),"Android NDK and Mac with M1 Apple Silicon CPUs"),(0,r.kt)("p",null,"We're aware of a series of incompatibilities between the Android NDK and Macs on M1 CPUs (",(0,r.kt)("a",u({parentName:"p"},{href:"https://github.com/android/ndk/issues/1299"}),"here")," and ",(0,r.kt)("a",u({parentName:"p"},{href:"https://github.com/android/ndk/issues/1410"}),"here"),").\nAs the New Architectecture relies on the NDK, you might face problems during your build."),(0,r.kt)("p",null,"React Native version 0.70 and 0.71 contains fixes for those build failures, and we invite you to update to those versions whenever possible."))}k.isMDXComponent=!0}}]);