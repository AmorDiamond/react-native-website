<!doctype html>
<html class="docs-version-0.65" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="React Native 中文网" href="/opensearch.xml">
<script src="//snack.expo.dev/embed.js" defer="defer"></script>
<script src="//cdn.wwads.cn/js/makemoney.js" defer="defer"></script><title data-react-helmet="true">发布自己定制的ReactNative包 · React Native 中文网</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="twitter:image" content="https://reactnative.cn/img/logo-og.png"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.65"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.65"><meta data-react-helmet="true" property="og:url" content="https://reactnative.cn"><meta data-react-helmet="true" property="og:image" content="img/logo-og.png"><meta data-react-helmet="true" property="og:title" content="发布自己定制的ReactNative包 · React Native 中文网"><meta data-react-helmet="true" name="description" content="TL;DR"><meta data-react-helmet="true" property="og:description" content="TL;DR"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://reactnative.cn/docs/0.65/publishing-forks"><link data-react-helmet="true" rel="alternate" href="https://reactnative.cn/docs/0.65/publishing-forks" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://reactnative.cn/docs/0.65/publishing-forks" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.f0955374.css">
<link rel="preload" href="/assets/js/runtime~main.b8dd0f7a.js" as="script">
<link rel="preload" href="/assets/js/main.32dbcf9a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_3wvD">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/header_logo.svg" alt="React Native 中文网" class="themedImage_Ir0T themedImage--light_2_E0"><img src="/img/header_logo.svg" alt="React Native 中文网" class="themedImage_Ir0T themedImage--dark_2JiM"></div><b class="navbar__title">React Native 中文网</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/0.65/getting-started">0.65</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/publishing-forks">Next</a></li><li><a class="dropdown__link" href="/docs/publishing-forks">0.66</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/0.65/publishing-forks">0.65</a></li><li><a class="dropdown__link" href="/docs/0.64/publishing-forks">0.64</a></li><li><a class="dropdown__link" href="/docs/0.63/publishing-forks">0.63</a></li><li><a class="dropdown__link" href="/versions">所有版本</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/0.65/getting-started">文档</a><a class="navbar__item navbar__link" href="/docs/0.65/components-and-apis">组件</a><a class="navbar__item navbar__link" href="/docs/0.65/accessibilityinfo">API</a><a class="navbar__item navbar__link" href="/docs/architecture-overview">架构</a><a href="//github.com/reactnativecn/react-native-website/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>讨论<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="//pushy.reactnative.cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link pushy"><span>热更新<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pqex"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/about">关于</a><a href="//github.com/facebook/react-native" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-github-link" aria-label="GitHub repository"></a><div class="toggle_2wFP toggle_2vag toggleDisabled_1jUP"><div class="toggleTrack_OYnE" role="button" tabindex="-1"><div class="toggleTrackCheck_3aVv"><span class="toggleIcon_1mQT">🌜</span></div><div class="toggleTrackX_oB48"><span class="toggleIcon_1mQT">🌞</span></div><div class="toggleTrackThumb_3qal"></div></div><input type="checkbox" class="toggleScreenReader_bg_d" aria-label="Switch between dark and light mode"></div><div class="searchBox_WYtD"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_3jyA"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_2PbN" type="button"></button><main class="docMainContainer_28SP docMainContainerEnhanced_YA74"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2rXS"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->React Native 中文网<!-- --> <b>0.65</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/publishing-forks">latest version</a></b> (<!-- -->0.66<!-- -->).</div></div><div class="docItemContainer_1EXp"><article><div><span class="badge badge--secondary">版本: <!-- -->0.65</span></div><div class="markdown"><header><h1>发布自己定制的ReactNative包</h1></header><h2 class="anchor anchorWithStickyNavbar_23Bc" id="tldr">TL;DR<a class="hash-link" href="#tldr" title="Direct link to heading">​</a></h2><p>There is a docker image that helps you build the required Android sources without installing any additional tooling (other than <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">Docker</a>, which can be committed to a git branch as a fully functional React Native fork release.</p><p>Run this from a fork of the React Native <a href="https://github.com/facebook/react-native" target="_blank" rel="noopener noreferrer">repo</a>.</p><div class="codeBlockContainer_1ukp theme-code-block"><div class="codeBlockContent_3Y8q jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git checkout </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">d release</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">my</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">react</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">native</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">release</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">docker run </span><span class="token operator" style="color:#fc929e">--</span><span class="token plain">rm </span><span class="token operator" style="color:#fc929e">--</span><span class="token plain">name rn</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">build </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">v $</span><span class="token constant" style="color:#5a9bcf">PWD</span><span class="token operator" style="color:#fc929e">:</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">pwd </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">w </span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">pwd reactnativecommunity</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">react</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">native</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">android </span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">bin</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">sh </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">c </span><span class="token string" style="color:#8dc891">&quot;./gradlew installArchives&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git add android </span><span class="token operator" style="color:#fc929e">--</span><span class="token plain">force</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git commit </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">a </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">m </span><span class="token string" style="color:#8dc891">&#x27;my react native forked release&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git push</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>Install it in your app project package.json.</p><div class="codeBlockContainer_1ukp theme-code-block"><div class="codeBlockContent_3Y8q jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token string" style="color:#8dc891">&quot;dependencies&quot;</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token operator" style="color:#fc929e">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;react-native&quot;</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;myName/react-native#release/my-react-native-release&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_23Bc" id="rationale">Rationale<a class="hash-link" href="#rationale" title="Direct link to heading">​</a></h2><p>The recommended approach to working with React Native is to always update to the latest version. No support is provided on older versions and if you run into issues the contributors will always ask you to upgrade to the latest version before even looking at your particular issue. Sometimes, though, you are temporarily stuck on an older React Native version, but you require some changes from newer versions urgently (bugfixes) without having to do a full upgrade right now. This situation should be short lived by definition and once you have the time, the real solution is to upgrade to the latest version.</p><p>With this goal of a shortlived fork of React Native in mind, you can publish your own version of React Native. The facebook/react-native repository contains all the dependencies required to be used directly as a git dependency, except for the Android React Native library binary (.aar).</p><h2 class="anchor anchorWithStickyNavbar_23Bc" id="building">Building<a class="hash-link" href="#building" title="Direct link to heading">​</a></h2><p>This binary needs to become available in your project&#x27;s <code>node_modules/react-native/android</code> folder or directly in your gradle dependency of your Android app. You can achieve this in one of two ways: Git dependency branch, Android binary dependency through Maven.</p><p>To build the .aar React Native library, you can follow the steps to <a href="/docs/0.65/building-from-source">build from source</a> first to install all required tooling. Then to build the actual library, you can run the following in the root of your react-native checkout:</p><div class="codeBlockContainer_1ukp language-$bash theme-code-block"><div class="codeBlockContent_3Y8q $bash"><pre tabindex="0" class="prism-code language-$bash codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">./gradlew :ReactAndroid:installArchives --no-daemon</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>If you don&#x27;t want to install the required toolchain for building from source, you can use a prebuilt docker image to create a react native binary;</p><div class="codeBlockContainer_1ukp theme-code-block"><div class="codeBlockContent_3Y8q jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">docker run </span><span class="token operator" style="color:#fc929e">--</span><span class="token plain">rm </span><span class="token operator" style="color:#fc929e">--</span><span class="token plain">name rn</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">build </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">v $</span><span class="token constant" style="color:#5a9bcf">PWD</span><span class="token operator" style="color:#fc929e">:</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">pwd </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">w </span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">pwd reactnativecommunity</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">react</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">native</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">android </span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">bin</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">sh </span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">c </span><span class="token string" style="color:#8dc891">&quot;./gradlew installArchives&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>If you haven&#x27;t used the Android NDK before or if you have a NDK version not exactly matching the required version for building React Native, this is the recommended approach.</p><p>The resulting binary can be made available to app projects in one of the two ways described below.</p><h3 class="anchor anchorWithStickyNavbar_23Bc" id="publishing-to-mavennexus">Publishing to Maven/Nexus<a class="hash-link" href="#publishing-to-mavennexus" title="Direct link to heading">​</a></h3><p>Upload the binaries from the <code>android</code> folder to maven and point your Android app project gradle dependency for React Native to your Maven/Nexus dependency.</p><h3 class="anchor anchorWithStickyNavbar_23Bc" id="publishing-to-a-git-fork-dependency">Publishing to a git fork dependency<a class="hash-link" href="#publishing-to-a-git-fork-dependency" title="Direct link to heading">​</a></h3><p>Instead of uploading to Maven/Nexus, you can add the binaries built in the previous steps to git, by changing the .gitignore and committing the binaries to your forked branch. This allows you to make your fork into a functioning git dependency for React Native app projects.</p><p>If you have changes that you want to actually merge to React Native, make them on another branch first and open a PR. To start making your dependency branch, make sure you are on a &#x27;release/my-forked-release&#x27; branch, then merge any commits that you need from yourself or others into this branch. This release branch should never be merged into any other branch.</p><div class="codeBlockContainer_1ukp language-$bash theme-code-block"><div class="codeBlockContent_3Y8q $bash"><pre tabindex="0" class="prism-code language-$bash codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"># create .aar, then:</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git add android --force</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git commit -m &#x27;my release commit&#x27;</span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">git push</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>Now you can use this branch as a git dependency in your app project, by pointing your package.json dependency to this branch:</p><div class="codeBlockContainer_1ukp theme-code-block"><div class="codeBlockContent_3Y8q jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_2Xgr thin-scrollbar" style="color:#FFFFFF;background:#282C34"><code class="codeBlockLines_3Zfi"><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token string" style="color:#8dc891">&quot;dependencies&quot;</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#657b83">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token operator" style="color:#fc929e">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;react-native&quot;</span><span class="token operator" style="color:#fc929e">:</span><span class="token plain"> &quot;my</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">name</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">react</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">native#release</span><span class="token operator" style="color:#fc929e">/</span><span class="token plain">my</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">forked</span><span class="token operator" style="color:#fc929e">-</span><span class="token plain">release</span><span class="token punctuation" style="color:#657b83">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain">    </span><span class="token operator" style="color:#fc929e">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#FFFFFF;background:#282C34"><span class="token plain"></span><span class="token punctuation" style="color:#657b83">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1mju clean-btn">Copy</button></div></div><p>No other modifications to your dependencies should be necessary for your native changes to be included in your project.</p></div><footer class="docMetadata row docusaurus-mt-lg"><div class="col"><a href="https://github.com/reactnativecn/react-native-website/blob/production/cnwebsite/../cndocs/publishing.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_1CBY" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_1szQ"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_rbnR thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tldr" class="table-of-contents__link toc-highlight">TL;DR</a></li><li><a href="#rationale" class="table-of-contents__link toc-highlight">Rationale</a></li><li><a href="#building" class="table-of-contents__link toc-highlight">Building</a><ul><li><a href="#publishing-to-mavennexus" class="table-of-contents__link toc-highlight">Publishing to Maven/Nexus</a></li><li><a href="#publishing-to-a-git-fork-dependency" class="table-of-contents__link toc-highlight">Publishing to a git fork dependency</a></li></ul></li></ul><div class="wwads-cn wwads-vertical" data-id="58" style="max-width:200px;margin-top:20px"></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">React Native 中文网 © 2022 武汉青罗网络科技有限公司
      <a style="margin-left:10px" href="http://beian.miit.gov.cn/">鄂ICP备20002031号-3</a>
      <img style="width:25px" src="//img.alicdn.com/tfs/TB1..50QpXXXXX7XpXXXXXXXXXX-40-40.png" alt="鄂公网安备 42011202001821号">
      <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42011202001821">鄂公网安备 42011202001821号</a>
      </div></div></div></footer></div>
<script src="/assets/js/runtime~main.b8dd0f7a.js"></script>
<script src="/assets/js/main.32dbcf9a.js"></script>
</body>
</html>